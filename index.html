<!doctype html>
<html lang="en-au">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Valentine’s Day</title>
  <style>
    :root{
      --pink-1:#ffe6eb;
      --pink-2:#ff4d6d;
      --pink-3:#d6003d;
      --ink:#2b2b2b;
      --glass: rgba(255,255,255,0.90);
      --border: rgba(214,0,61,0.16);
      --shadow: 0 18px 55px rgba(0,0,0,0.14);
      --shadow-strong: 0 22px 70px rgba(0,0,0,0.18);
    }

    *{ box-sizing:border-box; }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: radial-gradient(circle at top, var(--pink-1) 0%, #ffffff 55%, var(--pink-1) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
      text-align: center;
      position: relative;
      -webkit-tap-highlight-color: transparent;
    }

    .glow {
      position: absolute;
      inset: -240px;
      background:
        radial-gradient(circle at 15% 20%, rgba(214,0,61,0.18), transparent 45%),
        radial-gradient(circle at 85% 25%, rgba(255,77,109,0.16), transparent 50%),
        radial-gradient(circle at 50% 88%, rgba(214,0,61,0.12), transparent 55%);
      filter: blur(8px);
      z-index: 0;
      animation: drift 10s ease-in-out infinite;
    }

    @keyframes drift {
      0% { transform: translate(0, 0) scale(1); }
      50% { transform: translate(18px, -12px) scale(1.03); }
      100% { transform: translate(0, 0) scale(1); }
    }

    .sparkle-layer{
      position:absolute;
      inset:0;
      z-index:1;
      pointer-events:none;
      opacity:0.9;
      background:
        radial-gradient(circle at 18% 22%, rgba(255,255,255,0.9) 0 1px, transparent 2px),
        radial-gradient(circle at 72% 18%, rgba(255,255,255,0.85) 0 1px, transparent 2px),
        radial-gradient(circle at 40% 70%, rgba(255,255,255,0.75) 0 1px, transparent 2px),
        radial-gradient(circle at 85% 62%, rgba(255,255,255,0.8) 0 1px, transparent 2px),
        radial-gradient(circle at 12% 78%, rgba(255,255,255,0.7) 0 1px, transparent 2px),
        radial-gradient(circle at 55% 40%, rgba(255,255,255,0.75) 0 1px, transparent 2px);
      filter: blur(0.2px);
      animation: twinkle 3.2s ease-in-out infinite;
    }

    @keyframes twinkle{
      0%, 100% { opacity: 0.55; transform: translateY(0); }
      50% { opacity: 0.95; transform: translateY(-2px); }
    }

    .vignette{
      position:absolute;
      inset:-1px;
      z-index:2;
      pointer-events:none;
      background: radial-gradient(circle at 50% 40%, transparent 0 55%, rgba(0,0,0,0.06) 78%, rgba(0,0,0,0.12) 100%);
      mix-blend-mode: multiply;
    }

    .card {
      background: var(--glass);
      padding: 44px 46px;
      border-radius: 18px;
      box-shadow: var(--shadow);
      max-width: 520px;
      position: relative;
      z-index: 4;
      border: 1px solid var(--border);
      backdrop-filter: blur(10px);
      animation: popIn 700ms ease-out;
      transform-origin: center;
    }

    .card::before{
      content:"";
      position:absolute;
      inset:-1px;
      border-radius: 18px;
      padding:1px;
      background: linear-gradient(120deg,
        rgba(255,77,109,0.0),
        rgba(255,77,109,0.28),
        rgba(214,0,61,0.0)
      );
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      opacity:0.75;
      animation: sheen 2.8s ease-in-out infinite;
      pointer-events:none;
    }

    @keyframes sheen{
      0% { filter: blur(0px); transform: translateX(-10px); opacity: 0.45; }
      50% { filter: blur(0.2px); transform: translateX(10px); opacity: 0.9; }
      100% { filter: blur(0px); transform: translateX(-10px); opacity: 0.45; }
    }

    @keyframes popIn {
      0% { transform: scale(0.95); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    h1 {
      color: var(--pink-3);
      margin: 0 0 10px 0;
      letter-spacing: 0.2px;
    }

    p {
      font-size: 20px;
      color: var(--ink);
      margin: 0;
    }

    .sub {
      margin-top: 12px;
      font-size: 16px;
      color: rgba(214,0,61,0.9);
      animation: shimmer 1.6s ease-in-out infinite;
      user-select: none;
    }

    @keyframes shimmer {
      0%, 100% { transform: translateY(0); opacity: 0.75; }
      50% { transform: translateY(-3px); opacity: 1; }
    }

    .hint{
      display:inline-flex;
      align-items:center;
      gap:8px;
      justify-content:center;
    }
    .hint-dot{
      width:8px;
      height:8px;
      border-radius:999px;
      background: rgba(255,77,109,0.95);
      box-shadow: 0 0 0 0 rgba(255,77,109,0.38);
      animation: ping 1.8s ease-out infinite;
    }
    @keyframes ping{
      0% { box-shadow: 0 0 0 0 rgba(255,77,109,0.38); transform: scale(1); }
      70% { box-shadow: 0 0 0 10px rgba(255,77,109,0); transform: scale(1.05); }
      100% { box-shadow: 0 0 0 0 rgba(255,77,109,0); transform: scale(1); }
    }

    .heart {
      position: absolute;
      bottom: -60px;
      font-size: 24px;
      color: var(--pink-2);
      animation: floatUp linear infinite;
      opacity: 0.85;
      pointer-events: none;
      z-index: 1;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,0.12));
    }

    @keyframes floatUp {
      0% { transform: translateY(0) scale(1); opacity: 0.1; }
      12% { opacity: 0.95; }
      100% { transform: translateY(-115vh) scale(1.55); opacity: 0; }
    }

    .spark{
      position:absolute;
      bottom:-40px;
      width:6px;
      height:6px;
      border-radius:999px;
      background: rgba(255,255,255,0.95);
      box-shadow: 0 10px 24px rgba(0,0,0,0.10);
      opacity: 0.0;
      pointer-events:none;
      z-index: 1;
      animation: sparkUp linear infinite;
    }

    @keyframes sparkUp{
      0% { transform: translateY(0) scale(0.9); opacity: 0; }
      15% { opacity: 0.85; }
      100% { transform: translateY(-115vh) scale(1.2); opacity: 0; }
    }

    .burst {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: rgba(255,77,109,0.9);
      pointer-events: none;
      z-index: 7;
      opacity: 0;
      transform: scale(0.6);
      animation: burst 650ms ease-out forwards;
    }

    @keyframes burst {
      0% { opacity: 0; transform: scale(0.6); }
      20% { opacity: 1; transform: scale(1); }
      100% { opacity: 0; transform: scale(2.2); }
    }

    .ring{
      position:absolute;
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 2px solid rgba(255,77,109,0.65);
      pointer-events:none;
      z-index:7;
      opacity:0;
      transform: scale(0.5);
      animation: ring 700ms ease-out forwards;
    }

    @keyframes ring{
      0% { opacity: 0; transform: scale(0.35); }
      20% { opacity: 0.95; }
      100% { opacity: 0; transform: scale(2.8); }
    }

    .trail-heart{
      position: absolute;
      left: 0;
      top: 0;
      pointer-events: none;
      z-index: 6;
      color: rgba(255,77,109,0.95);
      filter: drop-shadow(0 10px 16px rgba(0,0,0,0.12));
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.7);
      animation: trailFloat 900ms ease-out forwards;
      will-change: transform, opacity;
    }

    @keyframes trailFloat{
      0% { opacity: 0; transform: translate(-50%, -50%) scale(0.6); }
      12% { opacity: 0.95; }
      100% { opacity: 0; transform: translate(-50%, calc(-50% - 26px)) scale(1.25); }
    }

    /* progress pill */
    .progress{
      position:absolute;
      top:14px;
      left:14px;
      z-index:8;
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,0.78);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(214,0,61,0.14);
      box-shadow: 0 10px 30px rgba(0,0,0,0.10);
      user-select:none;
    }
    .progress .dot{
      width:10px;
      height:10px;
      border-radius:999px;
      background: rgba(255,77,109,0.95);
      box-shadow: 0 0 0 0 rgba(255,77,109,0.30);
      animation: ping 2.4s ease-out infinite;
    }
    .progress .txt{
      font-size: 13px;
      color: rgba(214,0,61,0.92);
      letter-spacing: 0.2px;
      white-space: nowrap;
    }

    /* toast */
    .toast{
      position:absolute;
      bottom:18px;
      left:50%;
      transform: translateX(-50%);
      z-index:9;
      padding: 12px 14px;
      border-radius: 14px;
      background: rgba(255,255,255,0.82);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(214,0,61,0.14);
      box-shadow: 0 14px 40px rgba(0,0,0,0.12);
      color: rgba(214,0,61,0.92);
      font-size: 14px;
      opacity:0;
      pointer-events:none;
      transform-origin:center;
      transition: opacity 240ms ease, transform 240ms ease;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(-2px);
    }

    /* photo flip cards */
    .photo-card{
      position:absolute;
      opacity:0;
      transform: scale(0.9);
      transition: opacity 0.55s ease, transform 0.55s ease;
      z-index:3;
      pointer-events:auto;
      cursor:pointer;
      user-select:none;
      -webkit-user-drag:none;
      perspective: 900px;
      outline: 1px solid rgba(255,255,255,0.6);
      outline-offset: -6px;
      border-radius: 16px;
      will-change: transform, opacity;
    }

    .photo-card.show{
      opacity:1;
      transform: scale(1);
    }

    .photo-inner{
      position:relative;
      width:100%;
      height:100%;
      transform-style: preserve-3d;
      transition: transform 650ms cubic-bezier(0.2, 0.9, 0.2, 1);
      border-radius: 16px;
    }

    .photo-card.flipped .photo-inner{
      transform: rotateY(180deg);
    }

    .photo-face{
      position:absolute;
      inset:0;
      border-radius: 16px;
      overflow:hidden;
      backface-visibility:hidden;
      box-shadow: var(--shadow-strong);
    }

    .photo-front img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .photo-back{
      transform: rotateY(180deg);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
      background:
        radial-gradient(circle at 20% 15%, rgba(255,77,109,0.18), transparent 45%),
        radial-gradient(circle at 80% 85%, rgba(214,0,61,0.12), transparent 55%),
        rgba(255,255,255,0.92);
      border: 1px solid rgba(214,0,61,0.14);
    }

    .photo-back .msg{
      color: rgba(214,0,61,0.95);
      font-size: 16px;
      line-height: 1.35;
      max-width: 90%;
      text-align:center;
    }

    .photo-card.hide{
      opacity:0;
      transform: scale(0.92);
    }

    /* little flip sparkle burst */
    .flip-heart{
      position:absolute;
      left:0;
      top:0;
      pointer-events:none;
      z-index:8;
      color: rgba(255,77,109,0.98);
      opacity:0;
      transform: translate(-50%, -50%) scale(0.6);
      animation: flipPop 900ms ease-out forwards;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,0.14));
    }
    @keyframes flipPop{
      0% { opacity: 0; transform: translate(-50%, -50%) scale(0.6); }
      12% { opacity: 1; }
      100% { opacity: 0; transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(1.25); }
    }

    @media (max-width: 520px){
      .card{ padding: 34px 26px; margin: 0 14px; }
      .progress{ top:12px; left:12px; }
    }

    @media (prefers-reduced-motion: reduce){
      .glow, .sparkle-layer, .sub, .hint-dot, .heart, .spark, .trail-heart, .card::before{
        animation: none !important;
      }
      .photo-inner{
        transition: none !important;
      }
      .photo-card{
        transition: none !important;
      }
      .toast{
        transition: none !important;
      }
    }
  </style>
</head>
<body>

  <div class="glow"></div>
  <div class="sparkle-layer"></div>
  <div class="vignette"></div>

  <div class="progress" id="progress">
    <span class="dot" aria-hidden="true"></span>
    <span class="txt" id="progressText">Messages found 0 / 13</span>
  </div>

  <div class="toast" id="toast">All messages found. I love you.</div>

  <div class="card" id="card">
    <h1>Happy Valentine’s Day Izzi</h1>
    <p>I Love You</p>
    <div class="sub">
      <span class="hint">
        <span class="hint-dot" aria-hidden="true"></span>
        <span>tap or click anywhere</span>
      </span>
    </div>
  </div>

<script>
  const photos = [
    "images/photo1.jpg","images/photo2.jpg","images/photo3.jpg","images/photo4.jpg","images/photo5.jpg",
    "images/photo6.jpg","images/photo7.jpg","images/photo8.jpg","images/photo9.jpg","images/photo10.jpg",
    "images/photo11.jpeg","images/photo12.jpeg","images/photo13.jpeg"
  ];

  const photoTexts = [
    "Every day I spend with you is better than the last.",
    "I pick you. Every day.",
    "My favourite place is next to you.",
    "You make me feel calm.",
    "You make me laugh the most.",
    "I love your heart and your mind.",
    "You are my best decision.",
    "Life feels easier with you.",
    "You make me feel seen.",
    "You are home to me.",
    "I love how we are together.",
    "You bring out my best.",
    "I love you more than yesterday."
  ];

  const activeRects = [];
  let photoIndex = 0;

  let zTop = 10;

  const revealedSet = new Set();
  const progressTextEl = document.getElementById("progressText");
  const toastEl = document.getElementById("toast");

  function rectsOverlap(r1, r2) {
    return !(r2.left > r1.right || r2.right < r1.left || r2.top > r1.bottom || r2.bottom < r1.top);
  }

  function getCardRect(pad = 16) {
    const card = document.getElementById("card").getBoundingClientRect();
    return {
      left: card.left - pad,
      top: card.top - pad,
      right: card.right + pad,
      bottom: card.bottom + pad
    };
  }

  function clamp(value, min, max) {
    return Math.max(min, Math.min(max, value));
  }

  function getNextPhotoIndex() {
    const idx = photoIndex;
    photoIndex = (photoIndex + 1) % photos.length;
    return idx;
  }

  function setProgress() {
    progressTextEl.textContent = "Messages found " + revealedSet.size + " / " + photos.length;
    if (revealedSet.size >= photos.length) {
      showToast("All messages found. I love you.");
      sparkleCelebration();
    }
  }

  let toastTimer = null;
  function showToast(text) {
    toastEl.textContent = text;
    toastEl.classList.add("show");
    if (toastTimer) clearTimeout(toastTimer);
    toastTimer = setTimeout(() => toastEl.classList.remove("show"), 2200);
  }

  function createHeart() {
    const heart = document.createElement("div");
    heart.classList.add("heart");
    heart.textContent = Math.random() > 0.2 ? "♥" : "♡";
    heart.style.left = Math.random() * 100 + "vw";
    heart.style.fontSize = (18 + Math.random() * 42) + "px";
    heart.style.animationDuration = (3.8 + Math.random() * 4.2) + "s";
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 9000);
  }

  function createSpark() {
    const s = document.createElement("div");
    s.classList.add("spark");
    s.style.left = Math.random() * 100 + "vw";
    s.style.animationDuration = (4.5 + Math.random() * 5.0) + "s";
    s.style.opacity = "0";
    document.body.appendChild(s);
    setTimeout(() => s.remove(), 11000);
  }

  function burstAt(x, y) {
    const b = document.createElement("div");
    b.classList.add("burst");
    b.style.left = (x - 5) + "px";
    b.style.top = (y - 5) + "px";
    document.body.appendChild(b);
    setTimeout(() => b.remove(), 700);

    const r = document.createElement("div");
    r.classList.add("ring");
    r.style.left = (x - 8) + "px";
    r.style.top = (y - 8) + "px";
    document.body.appendChild(r);
    setTimeout(() => r.remove(), 760);
  }

  function flipHeartBurst(x, y) {
    const count = 10;
    for (let i = 0; i < count; i++) {
      const h = document.createElement("div");
      h.className = "flip-heart";
      h.textContent = Math.random() > 0.3 ? "♥" : "♡";
      h.style.left = x + "px";
      h.style.top = y + "px";
      h.style.fontSize = (10 + Math.random() * 12) + "px";
      h.style.setProperty("--dx", ((Math.random() * 90) - 45) + "px");
      h.style.setProperty("--dy", ((Math.random() * 90) - 45) + "px");
      document.body.appendChild(h);
      setTimeout(() => h.remove(), 980);
    }
  }

  function sparkleCelebration() {
    const w = window.innerWidth;
    const h = window.innerHeight;
    for (let i = 0; i < 22; i++) {
      const x = (w * 0.2) + Math.random() * (w * 0.6);
      const y = (h * 0.15) + Math.random() * (h * 0.5);
      setTimeout(() => {
        burstAt(x, y);
        flipHeartBurst(x, y);
      }, i * 45);
    }
  }

  // light audio ping on flip (only after user interaction)
  let audioReady = false;
  let audioCtx = null;
  function pingSound() {
    try {
      if (!audioReady) return;
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const t = audioCtx.currentTime;

      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();

      osc.type = "sine";
      osc.frequency.setValueAtTime(660, t);
      osc.frequency.exponentialRampToValueAtTime(990, t + 0.06);

      gain.gain.setValueAtTime(0.0001, t);
      gain.gain.exponentialRampToValueAtTime(0.12, t + 0.01);
      gain.gain.exponentialRampToValueAtTime(0.0001, t + 0.12);

      osc.connect(gain);
      gain.connect(audioCtx.destination);

      osc.start(t);
      osc.stop(t + 0.13);
    } catch (e) {}
  }

  function showPhotoAt(x, y) {
    const isSmall = window.matchMedia("(max-width: 520px)").matches;
    const size = isSmall ? 190 : 220;
    const padding = 12;

    let left = x - size / 2;
    let top = y - size / 2;

    left = clamp(left, padding, window.innerWidth - size - padding);
    top = clamp(top, padding, window.innerHeight - size - padding);

    const rect = { left, top, right: left + size, bottom: top + size };

    const cardRect = getCardRect(18);
    if (rectsOverlap(rect, cardRect)) return;

    for (const r of activeRects) {
      if (rectsOverlap(rect, r)) return;
    }

    const idx = getNextPhotoIndex();

    const card = document.createElement("div");
    card.className = "photo-card";
    card.style.width = size + "px";
    card.style.height = size + "px";
    card.style.left = rect.left + "px";
    card.style.top = rect.top + "px";
    card.style.zIndex = String(++zTop);

    const inner = document.createElement("div");
    inner.className = "photo-inner";

    const front = document.createElement("div");
    front.className = "photo-face photo-front";

    const img = document.createElement("img");
    img.src = photos[idx];
    img.alt = "Photo";
    front.appendChild(img);

    const back = document.createElement("div");
    back.className = "photo-face photo-back";

    const msg = document.createElement("div");
    msg.className = "msg";
    msg.textContent = photoTexts[idx] || "I love you.";
    back.appendChild(msg);

    inner.appendChild(front);
    inner.appendChild(back);
    card.appendChild(inner);

    const baseRot = (Math.random() * 2.8) - 1.4;
    card.dataset.baseRot = String(baseRot);

    function removeCard() {
      card.classList.add("hide");
      setTimeout(() => {
        const index = activeRects.indexOf(rect);
        if (index > -1) activeRects.splice(index, 1);
        card.remove();
      }, 520);
    }

    let flipped = false;
    let removeTimer = null;

    function flipAndScheduleRemove(clientX, clientY) {
      card.style.zIndex = String(++zTop);

      if (flipped) return;

      flipped = true;
      card.classList.add("flipped");

      flipHeartBurst(clientX, clientY);
      pingSound();

      if (!revealedSet.has(idx)) {
        revealedSet.add(idx);
        setProgress();
        showToast("Message found");
      }

      removeTimer = setTimeout(() => {
        removeCard();
      }, 5000);
    }

    function applyTiltFromPoint(clientX, clientY) {
      if (!card.isConnected) return;
      if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) return;

      const bounds = card.getBoundingClientRect();
      const cx = bounds.left + bounds.width / 2;
      const cy = bounds.top + bounds.height / 2;

      const dx = clamp((clientX - cx) / (bounds.width / 2), -1, 1);
      const dy = clamp((clientY - cy) / (bounds.height / 2), -1, 1);

      const rotY = dx * 8;
      const rotX = -dy * 8;

      const base = parseFloat(card.dataset.baseRot || "0");
      const flipY = card.classList.contains("flipped") ? 180 : 0;

      inner.style.transform = "rotateY(" + (flipY) + "deg) rotateX(" + rotX + "deg) rotateY(" + rotY + "deg)";
      card.style.transform = "scale(1) rotate(" + base + "deg)";
    }

    function clearTilt() {
      if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) return;
      inner.style.transform = "";
    }

    card.addEventListener("mousemove", (ev) => applyTiltFromPoint(ev.clientX, ev.clientY));
    card.addEventListener("mouseleave", () => clearTilt());

    card.addEventListener("click", (ev) => {
      ev.stopPropagation();
      flipAndScheduleRemove(ev.clientX, ev.clientY);
    });

    card.addEventListener("touchstart", (ev) => {
      const t = ev.touches[0];
      if (!t) return;
      ev.stopPropagation();
      flipAndScheduleRemove(t.clientX, t.clientY);
    }, { passive: true });

    document.body.appendChild(card);
    activeRects.push(rect);

    requestAnimationFrame(() => {
      card.classList.add("show");
      card.style.transform = "scale(1) rotate(" + baseRot + "deg)";
    });
  }

  function handlePoint(x, y) {
    burstAt(x, y);
    showPhotoAt(x, y);
    if (Math.random() > 0.55) createHeart();
  }

  function clearAllPhotos() {
    activeRects.length = 0;
    document.querySelectorAll(".photo-card").forEach(el => el.remove());
    showToast("Cleared");
  }

  document.addEventListener("click", (e) => {
    audioReady = true;
    handlePoint(e.clientX, e.clientY);
  });

  document.addEventListener("touchstart", (e) => {
    audioReady = true;
    const t = e.touches[0];
    if (!t) return;
    handlePoint(t.clientX, t.clientY);
  }, { passive: true });

  // double click background to clear
  document.addEventListener("dblclick", (e) => {
    const target = e.target;
    if (target && (target.classList && (target.classList.contains("photo-card") || target.closest(".photo-card")))) return;
    clearAllPhotos();
  });

  // keyboard shortcut
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") clearAllPhotos();
  });

  setInterval(createHeart, 220);

  setInterval(() => {
    if (Math.random() > 0.35) return;
    createSpark();
  }, 650);

  window.addEventListener("resize", () => {
    clearAllPhotos();
  });

  // trailing mouse hearts
  let lastTrail = 0;
  let lastX = 0;
  let lastY = 0;

  function createTrailHeart(x, y) {
    const h = document.createElement("div");
    h.className = "trail-heart";
    h.textContent = Math.random() > 0.25 ? "♥" : "♡";

    const size = 10 + Math.random() * 10;
    h.style.fontSize = size + "px";
    h.style.left = x + "px";
    h.style.top = y + "px";

    const rot = (Math.random() * 18) - 9;
    h.style.transform = "translate(-50%, -50%) scale(0.7) rotate(" + rot + "deg)";

    document.body.appendChild(h);
    requestAnimationFrame(() => { h.style.opacity = "1"; });

    setTimeout(() => h.remove(), 950);
  }

  function onMove(x, y) {
    const now = performance.now();
    const dx = x - lastX;
    const dy = y - lastY;
    const dist = Math.hypot(dx, dy);

    if (now - lastTrail < 18 && dist < 10) return;

    if (dist >= 14 || now - lastTrail >= 26) {
      createTrailHeart(x, y);
      lastTrail = now;
      lastX = x;
      lastY = y;
    }
  }

  document.addEventListener("mousemove", (e) => {
    onMove(e.clientX, e.clientY);
  });

  document.addEventListener("touchmove", (e) => {
    const t = e.touches[0];
    if (!t) return;
    onMove(t.clientX, t.clientY);
  }, { passive: true });

  setProgress();
</script>

</body>
</html>
